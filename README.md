# Системе подсчета пользовательских транзакций

## Описание архитектуры

Сервис состоит из API и хранилища транзакций.

Хранилище транзакций представляет базу данных ClickHouse, логика подсчета реализуется при помощи встроенных средств БД.

API реализует два метода:
* `/saveTransacction`
* `/getCountByPattern`

## Хранилище транзакций
Представляет из себя кластер ClickHouse.

Транзакции хранятся в таблице, каждый параметр транзакции - столбец в БД.

## API

API представляет из себя сервис для доступа к БД, протокол и формат данных (REST/gRPC/JSON) значения не имеют (можно выбрать подходящий после тестов)

Метод `/saveTransaction` принимает на вход данные о транзакции, после чего преобразует его к INSERT-запросу в базу и выполняет его

Метод `/getCountByPattern` принимает на вход паттерн, после чего преобразует его к аггрегирующему (COUNT) запросу SELECT из таблицы транзакций.

Сервис API запущен в нескольких экземплярах, роутинг осуществляется через nginx.


